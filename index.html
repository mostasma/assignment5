<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Emergency Service Directory</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

<!-- Navbar -->
<header class="sticky top-0 bg-white bg-opacity-80 backdrop-blur-md border-b border-gray-200 z-50">
  <div class="container mx-auto flex justify-between items-center h-16 px-4">
    <a href="#" class="flex items-center gap-2 font-bold text-gray-900">
      <img src="assets/logo.png" alt="Logo" class="w-12 h-12 rounded-full">
      <span class="bg-gradient-to-r from-green-500 to-green-600 bg-clip-text text-transparent font-bold">
        Emergency Service
      </span>  
    </a>
    <div class="flex items-center gap-4">
      <div class="flex items-center gap-3 px-10 py-2 rounded-full bg-green-50">
        <i class="fa-solid fa-heart text-pink-600"></i>
        <span id="heartCount">0</span>
      </div>
      <div class="flex items-center gap-3 px-10 py-2 rounded-full  bg-green-50"> 
        <span id="coinCount">100</span>
        <i class="fa-solid fa-coins text-yellow-600"></i>
      </div>
      <div class="flex items-center gap-3 px-10 py-2 rounded-full border border-green-200 bg-green-600">
        <i class="fa-regular fa-copy text-green-600"></i>
        <span id="copyCount">0 copy</span>
      </div>
    </div>
  </div>
</header>

<!-- Hero -->
<section class="bg-green-800 text-white text-center py-12 flex flex-col items-center">
  <img src="assets/logo-dark.png" alt="Logo" class="h-24 w-24 mb-4">
  <h1 class="text-3xl font-bold mb-2">Emergency Service Directory</h1>
  <p>Government Emergency Services at Your Fingertips â€” A project by Government of Bangladesh</p>
</section>


<!-- Main -->
<main class="container mx-auto px-4 py-8 grid grid-cols-1 lg:grid-cols-[1fr_320px] gap-6">
  
  <!-- Cards -->
  <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="cards"></section>

  <!-- History -->
  <aside class="bg-white border border-gray-200 rounded-lg sticky top-20 p-4">
    <div class="flex justify-between items-center mb-2">
      <div class="font-bold flex items-center gap-1"><i class="fa-solid fa-phone"></i> Call History</div>
      <button id="clearHistory" class="bg-green-500 text-white px-3 py-1 rounded">Clear</button>
    </div>
    <ul id="historyList" class="space-y-2 max-h-[70vh] overflow-auto">
      <li id="historyEmpty" class="text-center text-gray-500">No calls yet.</li>
    </ul>
  </aside>
</main>

<script>
  // ---------- Data ----------//
  const services = [
    { id:'nat-emergency', 
    icon:'ðŸ›¡ï¸',
    name:'National Emergency Number',
    localName:'national emergrncy', 
    number:'999', 
    category:'All' 
  },
    { id:'police', 
    icon:'ðŸ‘®', 
    name:'Police Helpline Number', 
    localName:'police', 
    number:'999', 
    category:'Police' 
  },
    { id:'fire', 
    icon:'ðŸš’', 
    name:'Fire Service Number', 
    localName:'Fire services',
    number:'999', 
    category:'Fire' 
  },
    { id:'ambulance', 
    icon:'ðŸš‘', 
    name:'Ambulance Service', 
    localName:'Ambulance', 
    number:'1994-9999999', 
    category:'Health' 
  },
    { id:'women-child', 
    icon:'ðŸ‘©â€ðŸ‘§', 
    name:'Women & Child Helpline', 
    localName:'Woman and children helpline', 
    number:'109', 
    category:'Help'  
  },
    { id:'anti-corruption', 
    icon:'ðŸ›¡ï¸', 
    name:'Anti-Corruption Helpline', 
    localName:'Anti-curreption', 
    number:'106', 
    category:'Govt.' },

    { id:'electricity', 
    icon:'ðŸ’¡', 
    name:'Electricity Helpline', 
    localName:'Electricity', 
    number:'16216', 
    category:'Electricity' },

    { id:'brac', 
    icon:'ðŸ¥', 
    name:'Brac Helpline', 
    localName:'Brack', 
    number:'16465', 
    category:'NGO' },

    { id:'rail', 
    icon:'ðŸš†', 
    name:'Bangladesh Railway Helpline', 
    localName:'Bangladesh Railway', 
    number:'163', 
    category:'Travel' }
  ];

  // ---------- State ----------//
  let coins = 100;
  let copyCount = 0;
  let heartCount = 0;

  // ---------- DOM ----------//
  const cardsEl = document.getElementById('cards');
  const coinEl = document.getElementById('coinCount');
  const copyEl = document.getElementById('copyCount');
  const heartEl = document.getElementById('heartCount');
  const historyList = document.getElementById('historyList');
  const historyEmpty = document.getElementById('historyEmpty');
  const clearBtn = document.getElementById('clearHistory');

  // ---------- Helpers ----------//
  const fmtTime = () => new Date().toLocaleTimeString([], { hour:'2-digit', minute:'2-digit', second:'2-digit' });
  const updatePills = () => {
    coinEl.textContent = coins;
    copyEl.textContent = copyCount + "copy";
    heartEl.textContent = heartCount;
  };

  // ---------- Render Cards ----------//
  function renderCards() {
    cardsEl.innerHTML = services.map(s => `
      <article class="bg-white border border-gray-200 rounded-lg p-4 shadow relative">
        <button class="fav absolute top-2 left-2 w-8 h-8 flex items-center justify-center text-pink-600"><i class="fa-solid fa-heart"></i></button>
        <div class="text-3xl text-center mb-2">${s.icon}</div>
        <div class="font-bold">${s.name}</div>
        <div class="text-gray-600 text-sm">${s.localName}</div>
        <div class="font-semibold text-lg mt-1">${s.number}</div>
        <span class="text-xs bg-gray-100 border border-gray-200 rounded-full px-2 py-0.5 mt-1 inline-block">${s.category}</span>
        <div class="grid grid-cols-2 gap-2 mt-3">
          <button class="btn ghost copy-btn flex items-center justify-center gap-1 px-2 py-1 border border-gray-300 rounded">
            <i class="fa-regular fa-copy"></i> Copy
          </button>
          <button class="btn primary call-btn flex items-center justify-center gap-1 px-2 py-1 rounded bg-green-500 text-white">
            <i class="fa-solid fa-phone"></i> Call
          </button>
        </div>
      </article>
    `).join('');
  }

  renderCards();

  // ---------- Event Delegation ----------
  cardsEl.addEventListener('click', async (e) => {
    const favBtn = e.target.closest('.fav');
    const copyBtn = e.target.closest('.copy-btn');
    const callBtn = e.target.closest('.call-btn');

    if(favBtn) {
      const isActive = favBtn.classList.toggle('text-pink-600/50');
      heartCount += isActive ? 1 : -1;
      if(heartCount < 0) heartCount = 0;
      updatePills();
    }

    if(copyBtn) {
      const card = copyBtn.closest('article');
      const number = card.querySelector('.text-lg').textContent;
      copyCount++;
      updatePills();
      try { await navigator.clipboard.writeText(number); } catch {}
      alert(`Copied ${number} to clipboard.`);
    }

    if(callBtn) {
      const card = callBtn.closest('article');
      const number = card.querySelector('.text-lg').textContent;
      const name = card.querySelector('.font-bold').textContent;
      if(coins < 20){ alert('Not enough coins (need 20)'); return; }
      coins -= 20;
      updatePills();
      alert(`Calling ${name} at ${number}...`);
      addToHistory({name, number, time: fmtTime()});
    }
  });

  function addToHistory(entry) {
    if(historyEmpty) historyEmpty.remove();
    const li = document.createElement('li');
    li.className = 'history-item border border-gray-200 rounded-lg p-2 bg-gray-50 flex justify-between';
    li.innerHTML = `
      <div>
        <div class="font-bold">${entry.name}</div>
        <div class="text-xs text-gray-600 flex gap-2"><span>ðŸ“± ${entry.number}</span><span>ðŸ•’ ${entry.time}</span></div>
      </div>
    `;
    historyList.prepend(li);
  }

  clearBtn.addEventListener('click', () => {
    historyList.innerHTML = '';
    const empty = document.createElement('li');
    empty.id = 'historyEmpty';
    empty.className = 'text-center text-gray-500';
    empty.textContent = 'No calls yet.';
    historyList.append(empty);
  });

  updatePills();
  
</script>

</body>
</html>
